# TODO: add release floating IP mechanism
- name: Clean floating IPs
  os_floating_ip:
      state: absent
      purge: yes
      cloud: "{{ provisioner.cloud | default(omit) }}"
      server: "{{ provisioner.prefix }}{{ node.value.name }}-{{ item }}"
      floating_ip_address: ""
      wait: yes
  with_sequence: start=0 end="{{ node.value.amount | int - 1 }}"

- name: Clean instances
  os_server:
      state: absent
      name: "{{ provisioner.prefix }}{{ node.value.name }}-{{ item }}"
      cloud: "{{ provisioner.cloud | default(omit) }}"
  with_sequence: start=0 end="{{ node.value.amount | int - 1 }}"

