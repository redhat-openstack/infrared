{% if installer.storage.external == "yes" %}
resource_registry:
    OS::TripleO::CephClusterConfig::SoftwareConfig: /usr/share/openstack-tripleo-heat-templates/puppet/extraconfig/ceph/ceph-external-config.yaml

parameter_defaults:
    CinderRbdPoolName: "automation-cinder"
    NovaRbdPoolName: "automation-nova"
    GlanceRbdPoolName: "automation-glance"
    CephClientUserName: "automation"
    CephClientKey: "{{ private.storage.ceph.CephClientKey }}"
    CephClusterFSID: "{{ private.storage.ceph.CephClusterFSID }}"
    CephExternalMonHost: "{{ private.storage.ceph.CephExternalMonHost }}"

{% else %}
parameter_defaults:
    CinderRbdPoolName: "volumes"
    NovaRbdPoolName: "vms"
    GlanceRbdPoolName: "images"
    ExtraConfig:
      ceph::profile::params::osds:
{% for disk in hostvars[(groups.ceph|first)].ansible_devices.keys()[1:] %}
       '/dev/{{ disk }}':
           journal: ''
{% endfor %}
{% endif %}

parameters:
    CinderEnableIscsiBackend: false
    CinderEnableRbdBackend: true
    CinderEnableNfsBackend: false
    NovaEnableRbdBackend: true
    GlanceBackend: rbd
