---
- name: check if user provided storage templates
  stat:
      path: "{{ template_base }}/storage"
  register: storage

- name: append the storage template line to the base overcloud deploy script
  lineinfile:
      dest: "~/overcloud_deploy.sh"
      line: '-e /usr/share/openstack-tripleo-heat-templates/environments/storage-environment.yaml \'
  when: storage.stat.exists == False and installer.storage.backend

# If user provided storage templates, nothing to do here :)
- include: "{{ installer.storage.backend }}.yml"
  when: storage.stat.exists == False and installer.storage.backend
