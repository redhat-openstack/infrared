{
  "comments": [
    {
      "key": {
        "uuid": "53516b2e_a17ed77f",
        "filename": "plugins/virsh/tasks/download_images.yml",
        "patchSetId": 2
      },
      "lineNbr": 34,
      "author": {
        "id": 1005097
      },
      "writtenOn": "2019-09-04T14:46:03Z",
      "side": 1,
      "message": "Doesn\u0027t this var already contain the file(s) with suffix \".original\" since it was set in \"dest\"?\n({{ base_image_path }}/{{ source | basename }}.original # L11)",
      "revId": "70945476cee7a48da546c34bc48b96b3cd98dcb3",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "53a7bcaa_80425e29",
        "filename": "plugins/virsh/tasks/download_images.yml",
        "patchSetId": 2
      },
      "lineNbr": 34,
      "author": {
        "id": 1001189
      },
      "writtenOn": "2019-09-04T15:52:38Z",
      "side": 1,
      "message": "Yes it does.\nThat\u0027s why next line #35 strips the .original from the end of string.",
      "parentUuid": "53516b2e_a17ed77f",
      "revId": "70945476cee7a48da546c34bc48b96b3cd98dcb3",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "cafb3933_cf9713f7",
        "filename": "plugins/virsh/tasks/download_images.yml",
        "patchSetId": 2
      },
      "lineNbr": 36,
      "author": {
        "id": 1016895
      },
      "writtenOn": "2019-09-13T14:32:45Z",
      "side": 1,
      "message": "Rather than do a copy here, you could also implement a copy-on-write image backed by the original file - that\u0027d keep the space down, and it would execute really quickly.",
      "revId": "70945476cee7a48da546c34bc48b96b3cd98dcb3",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "aafb395e_4f3fb189",
        "filename": "plugins/virsh/tasks/download_images.yml",
        "patchSetId": 2
      },
      "lineNbr": 36,
      "author": {
        "id": 1001189
      },
      "writtenOn": "2019-11-04T13:20:25Z",
      "side": 1,
      "message": "That would be unrelated change to this \"fix\", and especially, it was done in past, but caused issues and had to be reverted.\n\nI cannot remember what the issue was, but it was bad and iirc there was no easy way around it.\nWas able to just find original commit and its revert where there are no details about what it broke: https://review.gerrithub.io/c/redhat-openstack/infrared/+/411287 and https://review.gerrithub.io/c/redhat-openstack/infrared/+/412050\n\nSo if this should be attempted again, it needs to be really separate change, and whatever the issue was in past to be understood first.",
      "parentUuid": "cafb3933_cf9713f7",
      "revId": "70945476cee7a48da546c34bc48b96b3cd98dcb3",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "884fb62e_46a4921b",
        "filename": "plugins/virsh/tasks/download_images.yml",
        "patchSetId": 2
      },
      "lineNbr": 36,
      "author": {
        "id": 1001189
      },
      "writtenOn": "2019-11-04T13:29:31Z",
      "side": 1,
      "message": "I was able to find some info in old email: issue is we need to resize the disk\u0027s (virtual) size, to have it way bigger then the default/original image is. With having layer on top of backing file runs were failing with no space left on device e.g.:\n\n\u003e \u003e   12:05:59 + openstack overcloud image upload --update-existing\n\u003e \u003e   12:05:59 500 Internal Server Error: The server has either erred or is incapable of performing the requested operation. (HTTP 500)\n\u003e\n\u003e Also in the undercloud-0 logs you can find following error message that also related to issue is caused by patch.\n\u003e\n\u003e \u003e   $ grep \u0027No space left on device\u0027 -Rn undercloud-0/var/log/messages \n\u003e \u003e   18368:May 22 08:05:52 undercloud-0 object-server: ERROR __call__ error with PUT /1/989/AUTH_4a35644cbb0b451480ad0851a3054c0c/glance/6d951365-e469-4bfb-b04b-97cb24e60dd6-00001 : [Errno 28] No space left on device (txn: txeda001717716492689b75-005b04079f)",
      "parentUuid": "aafb395e_4f3fb189",
      "revId": "70945476cee7a48da546c34bc48b96b3cd98dcb3",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "538d5348_b8bd8c9d",
        "filename": "plugins/virsh/tasks/download_images.yml",
        "patchSetId": 2
      },
      "lineNbr": 36,
      "author": {
        "id": 1016895
      },
      "writtenOn": "2019-11-05T10:11:07Z",
      "side": 1,
      "message": "Fantastic, thank you for the background - and yes, I acknowledge that this can be done as a totally separate patch.",
      "parentUuid": "884fb62e_46a4921b",
      "revId": "70945476cee7a48da546c34bc48b96b3cd98dcb3",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    }
  ]
}