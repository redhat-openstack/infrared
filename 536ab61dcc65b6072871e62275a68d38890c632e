{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "b690fd9b_1573cb8d",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 11
      },
      "lineNbr": 0,
      "author": {
        "id": 1016110
      },
      "writtenOn": "2022-03-08T09:09:53Z",
      "side": 1,
      "message": "I suspected it couldn\u0027t work, and in fact the template in a default value doesn\u0027t seem to work:\n\n2022-03-07 22:23:15.161 | ERROR   \u003cclass \u0027ansible.errors.AnsibleParserError\u0027\u003e: The field \u0027hosts\u0027 has an invalid value, which includes an undefined variable. The error was: {\u0027cleanup\u0027: False, \u0027collect\u0027: {\u0027ansible\u0027: {\u0027facts\u0027: False}}, \u0027configure\u0027: {\u0027whitebox\u0027: {\u0027db\u0027: False, \u0027plugin\u0027: False}}, \u0027customized\u0027: {\u0027image\u0027: {\u0027flavor\u0027: False}}, \u0027debug\u0027: {\u0027command\u0027: \u0027sosreport --batch --build --tmp-dir /var/log/extra --log-size\u003d1 -p openstack\u0027}, \u0027dir\u0027: \u0027tempest-dir\u0027, \u0027image\u0027: \u0027http://rhos-qe-mirror-tlv.usersys.redhat.com/images/cirros-0.4.0-x86_64-disk.img\u0027, \u0027install\u0027: {\u0027crudini\u0027: False}, \u0027legacy\u0027: {\u0027config\u0027: False}, \u0027list\u0027: False, \u0027mode\u0027: \u0027normal\u0027, \u0027openstack\u0027: {\u0027installer\u0027: \u0027tripleo\u0027, \u0027version\u0027: \u002716.1\u0027}, \u0027results\u0027: {\u0027dir\u0027: \u0027{{ inventory_dir }}/test_results\u0027, \u0027formats\u0027: \u0027junitxml,html\u0027}, \u0027revision\u0027: \u0027HEAD\u0027, \u0027rpm\u0027: {\u0027package\u0027: \u0027\u0027}, \u0027setup\u0027: \u0027rpm\u0027, \u0027tempest\u0027: {\u0027config\u0027: True}, \u0027test\u0027: {\u0027step\u0027: {\u0027id\u0027: \u00271\u0027}, \u0027suite\u0027: {\u0027prefix\u0027: \u0027\u0027}}, \u0027tests\u0027: [\u0027/home/rhos-ci/jenkins/workspace/gate-infrared-tripleo-overcloud-osp16.1-ipv4/infrared/plugins/tempest/vars/tests/minimal.yml\u0027], \u0027threads\u0027: 8}: \u0027inventory_dir\u0027 is undefined\n\nUnless I\u0027ve missed something simple, just go for the easy solution: remove the default value at all, and add a line in the main of each plugin which checks if the variables was defined. If it is defined, save its value in fact, and if is not defined, set the value of that fact to {{ inventory_dir }}/test_results, and then use that fact.",
      "revId": "536ab61dcc65b6072871e62275a68d38890c632e",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "dee566c0_08f81321",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 11
      },
      "lineNbr": 0,
      "author": {
        "id": 1004057
      },
      "writtenOn": "2022-03-10T16:53:28Z",
      "side": 1,
      "message": "Great job, Adrian!\n\nPlease see my comments and make sure to test your changes and provide links to POC jobs!!",
      "revId": "536ab61dcc65b6072871e62275a68d38890c632e",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2b89c1e9_8266a857",
        "filename": "plugins/ospdui/run.yml",
        "patchSetId": 11
      },
      "lineNbr": 6,
      "author": {
        "id": 1016110
      },
      "writtenOn": "2022-03-10T16:13:57Z",
      "side": 1,
      "message": "can\u0027t you use just a single set_fact? I haven\u0027t tested but something along the line of the following example should work:\n\n test_results_dir: {{ test.results.dir|default(inventory_dir+\u0027/test_results\u0027) }}",
      "revId": "536ab61dcc65b6072871e62275a68d38890c632e",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "cd78f729_04312443",
        "filename": "plugins/ospdui/run.yml",
        "patchSetId": 11
      },
      "lineNbr": 45,
      "author": {
        "id": 1004057
      },
      "writtenOn": "2022-03-10T16:53:28Z",
      "side": 1,
      "message": "Not a must - you can use set_fact to create a new variable \u0027result_file\u0027 instead of using {{ test_suite }}.xml",
      "range": {
        "startLine": 45,
        "startChar": 28,
        "endLine": 45,
        "endChar": 48
      },
      "revId": "536ab61dcc65b6072871e62275a68d38890c632e",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "dcdfe4ca_12c0164b",
        "filename": "plugins/pytest-runner/pytest_run.yml",
        "patchSetId": 11
      },
      "lineNbr": 18,
      "author": {
        "id": 1004057
      },
      "writtenOn": "2022-03-10T16:53:28Z",
      "side": 1,
      "message": "ternary",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 18,
        "endChar": 0
      },
      "revId": "536ab61dcc65b6072871e62275a68d38890c632e",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5f7f315c_da8a4684",
        "filename": "plugins/pytest-runner/pytest_run.yml",
        "patchSetId": 11
      },
      "lineNbr": 88,
      "author": {
        "id": 1004057
      },
      "writtenOn": "2022-03-10T16:53:28Z",
      "side": 1,
      "message": "Where do you store the file? On the controlled or managed node?",
      "range": {
        "startLine": 88,
        "startChar": 0,
        "endLine": 88,
        "endChar": 60
      },
      "revId": "536ab61dcc65b6072871e62275a68d38890c632e",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "023873c1_36ac1a9a",
        "filename": "plugins/rally/tasks/post/report.yml",
        "patchSetId": 11
      },
      "lineNbr": 91,
      "author": {
        "id": 1004057
      },
      "writtenOn": "2022-03-10T16:53:28Z",
      "side": 1,
      "message": "DRY!",
      "range": {
        "startLine": 65,
        "startChar": 0,
        "endLine": 91,
        "endChar": 56
      },
      "revId": "536ab61dcc65b6072871e62275a68d38890c632e",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    }
  ]
}