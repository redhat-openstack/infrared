- block:
    - stat:
          path: "vars/topology/nodes/{{ name }}.yml"
      register: file
      delegate_to: localhost

    # save current node to "{{ node_dict }}"
    - include_vars: "{{ (file.stat.exists) | ternary(file.stat.path, 'vars/topology/nodes/default/{0}.yml'.format(node.key)) }}"

    - set_fact:
          nodes: "{{ nodes|default([]) + [node_dict] }}"
  vars:
      name: "{{ node.key }}"
      amount: "{{ node.value }}"
