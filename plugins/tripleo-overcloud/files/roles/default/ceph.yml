---
ceph_role:
    name: CephStorage

    resource_registry:
        OS::TripleO::CephStorage::Net::SoftwareConfig: "${deployment_dir}/network/nic-configs/ceph-storage.yaml"
        OS::TripleO::CephStorage::Ports::ExternalPort: "{{ install.heat.templates.basedir }}/network/ports/noop.yaml"
        OS::TripleO::CephStorage::Ports::InternalApiPort: "{{ install.heat.templates.basedir }}/network/ports/noop.yaml"
        OS::TripleO::CephStorage::Ports::StoragePort: "{{ install.heat.templates.basedir }}/network/ports/storage.yaml"
        OS::TripleO::CephStorage::Ports::StorageMgmtPort: "{{ install.heat.templates.basedir }}/network/ports/storage_mgmt.yaml"
        OS::TripleO::CephStorage::Ports::TenantPort: "{{ install.heat.templates.basedir }}/network/ports/noop.yaml"
        #OS::TripleO::CephStorage::Ports::ManagementPort: "{{ install.heat.templates.basedir }}/network/ports/management.yaml"

    flavor: ceph
    host_name_format: 'ceph-%index%'

    services:
        - OS::TripleO::Services::CACerts
        - OS::TripleO::Services::CephOSD
        - OS::TripleO::Services::Kernel
        - OS::TripleO::Services::Ntp
        - OS::TripleO::Services::Timezone
        - OS::TripleO::Services::TripleoPackages
        - OS::TripleO::Services::TripleoFirewall
        - OS::TripleO::Services::SensuClient
        - OS::TripleO::Services::FluentdClient
        - "{% if install.version|default(undercloud_version) |openstack_release < 11 %}OS::TripleO::Services::VipHosts{% endif %}"
        - "{% if install.version|default(undercloud_version) |openstack_release > 10 %}OS::TripleO::Services::MySQLClient{% endif %}"
        - "{% if roles_sshd %}OS::TripleO::Services::Sshd{% endif %}"
