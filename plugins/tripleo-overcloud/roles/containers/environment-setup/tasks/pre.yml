- name: get puddle url from the repos
  vars:
      repod_file: "/etc/yum.repos.d/rhos-release-{{ undercloud_version|int|default(install.version) }}.repo"
  shell: |
      cat {{ repod_file }} | awk -F "=" '/puddle_baseurl/ {print $2}' | head -n1 | grep -Po '.*(?=\/.*\/\$basearch)'
  register: containers_puddle_base_url

- name: get puddle number
  command: "/usr/bin/puddle-version {{ containers_puddle_base_url.stdout }}"
  register: containers_puddle_number

- name: puddle to be used
  debug:
      msg: "{{ containers_puddle_number.stdout }}"
