---
- name: create public VIP environment file
  template:
      src: ssl/public_vip.yaml.j2
      dest: "{{ temp_dir }}/public_vip.yaml"

- name: append the invocation line to the base overcloud deploy script
  lineinfile:
      dest: "{{ overcloud_deploy_script }}"
      insertbefore: '^--log-file.*'
      line: '-e {{ temp_dir }}/public_vip.yaml \'

- name: append the invocation line to the base overcloud deploy script
  lineinfile:
      dest: "{{ overcloud_deploy_script }}"
      insertbefore: '^--log-file.*'
      line: '-e /usr/share/openstack-tripleo-heat-templates/environments/tls-endpoints-public-ip.yaml \'