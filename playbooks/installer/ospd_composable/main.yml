---
- include: ../ospd/pre.yml

- name: Setup our undercloud
  include: ../ospd/undercloud/main.yml

- name: Install overcloud
  include: overcloud/main.yml
  vars:
      template_base: "/home/{{ installer.user.name }}/{{ installer.deployment.files.rstrip('/') | basename }}"
      network_environment_file: "network-environment{{ (installer.network.protocol == 'ipv6') | ternary('-v6','') }}.yaml"
      network_vips_file: "vips{{ (installer.network.protocol == 'ipv6') | ternary('-v6','') }}.yaml"
      overcloud_deploy_script: ''
  tags:
      - overcloud
      - composable_roles
