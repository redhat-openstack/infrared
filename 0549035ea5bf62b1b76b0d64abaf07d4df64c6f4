{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "63a1a0f6_13c6f47c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 9
      },
      "lineNbr": 0,
      "author": {
        "id": 1006992
      },
      "writtenOn": "2021-11-30T14:23:24Z",
      "side": 1,
      "message": "Looking good Filip! Two comments below.",
      "revId": "0549035ea5bf62b1b76b0d64abaf07d4df64c6f4",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "33c9389e_fff265ac",
        "filename": "plugins/tripleo-overcloud/deploy.yml",
        "patchSetId": 9
      },
      "lineNbr": 99,
      "author": {
        "id": 1006992
      },
      "writtenOn": "2021-11-30T14:23:24Z",
      "side": 1,
      "message": "Rather than make a copy of this file and edit it, you should be able to use the --container-namespace option as below so that the CLI tool does the replacement for you. \n\n  --container-namespace 192.168.24.1:8787\n  --container-image-prepare \"{{ containers_home_dir }}/containers-prepare-parameter.yaml\"\n\nFeel free to try this option if it\u0027s easier for you (less tasks, less changes). It also tests that aspect of the tool. Thanks.",
      "range": {
        "startLine": 98,
        "startChar": 0,
        "endLine": 99,
        "endChar": 42
      },
      "revId": "0549035ea5bf62b1b76b0d64abaf07d4df64c6f4",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "65d6704c_bfba4f0a",
        "filename": "plugins/tripleo-overcloud/deploy.yml",
        "patchSetId": 9
      },
      "lineNbr": 99,
      "author": {
        "id": 1005097
      },
      "writtenOn": "2021-12-01T09:58:41Z",
      "side": 1,
      "message": "Done since #9.",
      "parentUuid": "33c9389e_fff265ac",
      "range": {
        "startLine": 98,
        "startChar": 0,
        "endLine": 99,
        "endChar": 42
      },
      "revId": "0549035ea5bf62b1b76b0d64abaf07d4df64c6f4",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "86f63859_173700dc",
        "filename": "plugins/tripleo-overcloud/deploy.yml",
        "patchSetId": 9
      },
      "lineNbr": 99,
      "author": {
        "id": 1005097
      },
      "writtenOn": "2021-12-01T11:12:23Z",
      "side": 1,
      "message": "This actually doesn\u0027t work, when I use the file it does, but using\n\nopenstack overcloud ceph deploy -o /home/stack/templates/overcloud-ceph-deployed.yaml /home/stack/templates/overcloud-baremetal-deployed.yaml  --container-namespace 192.168.24.1:8787 --container-image-p\nrepare /home/stack/containers-prepare-parameter.yaml --container-image rhceph --container-tag 5-12\n\nfails with:\nusr/sbin/cephadm\\\", line 3333, in _pull_image\", \"    raise RuntimeError(\u0027Failed command: %s\u0027 % cmd_str)\", \"RuntimeError: Failed co\nmmand: /bin/podman pull 192.168.24.1:8787/rhceph:5-12\"], \"stdout\": \"\", \"stdout_lines\": []\n\nnot sure why, do you wanna me create a BZ for it? Maybe there is an issue in the replacement handling in cephadm or I am doing smth wrong?",
      "parentUuid": "65d6704c_bfba4f0a",
      "range": {
        "startLine": 98,
        "startChar": 0,
        "endLine": 99,
        "endChar": 42
      },
      "revId": "0549035ea5bf62b1b76b0d64abaf07d4df64c6f4",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "104788a1_25725da2",
        "filename": "plugins/tripleo-overcloud/deploy.yml",
        "patchSetId": 9
      },
      "lineNbr": 99,
      "author": {
        "id": 1016970
      },
      "writtenOn": "2021-12-01T11:23:53Z",
      "side": 1,
      "message": "Hey Filip, from what I see you are using a wrong --container-namespace:\n\nyou have: --container-namespace 192.168.24.1:8787\nwhile it should be:\n\n--container-namespace 192.168.24.1:8787/rhobs\n\nwhich is described in the doc [1]\n\n[1] https://docs.openstack.org/project-deploy-guide/tripleo-docs/latest/features/deployed_ceph.html",
      "parentUuid": "86f63859_173700dc",
      "range": {
        "startLine": 98,
        "startChar": 0,
        "endLine": 99,
        "endChar": 42
      },
      "revId": "0549035ea5bf62b1b76b0d64abaf07d4df64c6f4",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b6ecbc2a_f145af50",
        "filename": "plugins/tripleo-overcloud/deploy.yml",
        "patchSetId": 9
      },
      "lineNbr": 99,
      "author": {
        "id": 1005097
      },
      "writtenOn": "2021-12-01T11:31:16Z",
      "side": 1,
      "message": "Ah, I missed that, thx.",
      "parentUuid": "104788a1_25725da2",
      "range": {
        "startLine": 98,
        "startChar": 0,
        "endLine": 99,
        "endChar": 42
      },
      "revId": "0549035ea5bf62b1b76b0d64abaf07d4df64c6f4",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "63760ff0_0955fa00",
        "filename": "plugins/tripleo-overcloud/deploy.yml",
        "patchSetId": 9
      },
      "lineNbr": 99,
      "author": {
        "id": 1005097
      },
      "writtenOn": "2021-12-02T11:58:45Z",
      "side": 1,
      "message": "You know I thought about this much more and I think I will revert into my previous implementation in next patchset, as the final one, for several reasons (though also I have the \"--parameter way\" confirmed working):\n\n0) containers-prepare-parameter.yaml is single source of \"truth\" about container metadata, which is downloaded then post-processed using IR. In this stage, right before OC deployment itself, the file contains also all the tweaks (e.g. mirrors, string replacements [3,4]) and changes related to specific automation - which are very likely related to also deployed ceph workflow already (as it was part of OC deployment before, these were being applied anyway). RelDel is provider of the containers and metadata, which is only being mirrored as it goes thru CI pipeline down - we should stick to use this file first, use --parameter based modifications only if needed by specific workflows second.\n\n1) containers-prepare-parameter.yaml contents might change in time (any of it, it already had happened in the past), hardcoding any parameter like \"--container-namespace\" here at IR layer might break. Lets keep these parameter overrides on following patches focusing on phase3 usages...\n\n2) supported by same workflow also used for container patching plugins/tripleo-overcloud/roles/containers/prepare-templates/tasks/build/patch_images_tripleo-modify-image.yml\n\n[3] plugins/tripleo-undercloud/tasks/prepare_uc_images_builtin.yml\n[4] ./plugins/tripleo-overcloud/roles/containers/prepare-templates/tasks/build/build_images.yml",
      "parentUuid": "b6ecbc2a_f145af50",
      "range": {
        "startLine": 98,
        "startChar": 0,
        "endLine": 99,
        "endChar": 42
      },
      "revId": "0549035ea5bf62b1b76b0d64abaf07d4df64c6f4",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f764119d_14d2ab68",
        "filename": "plugins/tripleo-overcloud/deploy.yml",
        "patchSetId": 9
      },
      "lineNbr": 99,
      "author": {
        "id": 1005097
      },
      "writtenOn": "2021-12-02T12:06:08Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "63760ff0_0955fa00",
      "range": {
        "startLine": 98,
        "startChar": 0,
        "endLine": 99,
        "endChar": 42
      },
      "revId": "0549035ea5bf62b1b76b0d64abaf07d4df64c6f4",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8734774a_d51173a5",
        "filename": "plugins/tripleo-overcloud/deploy.yml",
        "patchSetId": 9
      },
      "lineNbr": 107,
      "author": {
        "id": 1006992
      },
      "writtenOn": "2021-11-30T14:23:24Z",
      "side": 1,
      "message": "Please consider adding the following here:\n\n  --network-data /home/stack/virt/network/network_data_v2.yaml\n\nThe following has merged in Wallaby and should soon be in the compose so that you can use the above option (which will become a required argument). Thanks.\n\nhttps://review.opendev.org/q/topic:%22bug%252F1950178-stable%252Fwallaby%22+(status:open%20OR%20status:merged)",
      "revId": "0549035ea5bf62b1b76b0d64abaf07d4df64c6f4",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "3b3f3f6d_eff17c5a",
        "filename": "plugins/tripleo-overcloud/deploy.yml",
        "patchSetId": 9
      },
      "lineNbr": 107,
      "author": {
        "id": 1005097
      },
      "writtenOn": "2021-12-01T09:58:41Z",
      "side": 1,
      "message": "Done since #9.",
      "parentUuid": "8734774a_d51173a5",
      "revId": "0549035ea5bf62b1b76b0d64abaf07d4df64c6f4",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ff1fba69_cb49384b",
        "filename": "plugins/tripleo-overcloud/deploy.yml",
        "patchSetId": 9
      },
      "lineNbr": 107,
      "author": {
        "id": 1005097
      },
      "writtenOn": "2021-12-01T11:12:23Z",
      "side": 1,
      "message": "I just tested on RHOS-17.0-RHEL-8-20211105.n.0 and there is no \"--network-data\" yes, so we might need to postpone this until it hits downstream (maybe already did in newer builds, dunno).",
      "parentUuid": "3b3f3f6d_eff17c5a",
      "revId": "0549035ea5bf62b1b76b0d64abaf07d4df64c6f4",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "23cc799f_f645ec09",
        "filename": "plugins/tripleo-overcloud/deploy.yml",
        "patchSetId": 9
      },
      "lineNbr": 107,
      "author": {
        "id": 1005097
      },
      "writtenOn": "2021-12-02T11:30:08Z",
      "side": 1,
      "message": "Reevaluated,in RHOS-17.0-RHEL-8-20211201.n.0 we have such option, but that build is really fresh and did not pass phase1 without workaround, therefore I tend to wait with this addition - though I tried to run with/without it on latest 1201 content and ceph deploy passed, that change would not be backward compatible with 1105 content mostly used to deploy OSP17.\n\nI suggest this one for additional followup patch.",
      "parentUuid": "ff1fba69_cb49384b",
      "revId": "0549035ea5bf62b1b76b0d64abaf07d4df64c6f4",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f05cc37b_598dd287",
        "filename": "plugins/tripleo-overcloud/deploy.yml",
        "patchSetId": 9
      },
      "lineNbr": 107,
      "author": {
        "id": 1005097
      },
      "writtenOn": "2021-12-02T11:46:35Z",
      "side": 1,
      "message": "Followup will be waiting here: https://review.gerrithub.io/c/redhat-openstack/infrared/+/528642 .",
      "parentUuid": "23cc799f_f645ec09",
      "revId": "0549035ea5bf62b1b76b0d64abaf07d4df64c6f4",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    }
  ]
}