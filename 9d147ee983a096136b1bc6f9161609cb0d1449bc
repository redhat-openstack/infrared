{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "3be00545_41a89a6c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 1019722
      },
      "writtenOn": "2022-06-01T09:23:53Z",
      "side": 1,
      "message": "recheck",
      "revId": "9d147ee983a096136b1bc6f9161609cb0d1449bc",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "2abc5908_5ca29edc",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 1019722
      },
      "writtenOn": "2022-06-01T09:32:51Z",
      "side": 1,
      "message": "So, the issue now appears to be that we\u0027re unable to find any networks for this node:\n\n```\n[stack@undercloud-0 outputs]$ cat RoleNetHostnameMap \nStandalone:\n  canonical:\n  - aio-0.redhat.local\n  ctlplane:\n  - aio-0.ctlplane.redhat.local\n  external:\n  - aio-0.external.redhat.local\n  internal_api:\n  - aio-0.internalapi.redhat.local\n  storage:\n  - aio-0.storage.redhat.local\n  storage_mgmt:\n  - aio-0.storagemgmt.redhat.local\n  storage_nfs:\n  - aio-0.storagenfs.redhat.local\n  tenant:\n  - aio-0.tenant.redhat.local\n```\n\nPotentially something we\u0027re missing the baremetal_deployment.yaml file. Will need to dig into that, but the deployment fails because it can\u0027t find a IP address for the node on the ctlplane network while generating the inventory file.\n\nThe error:\n```\n2022-06-01 09:29:08.899088 | 525400e6-4dcf-ba75-8f8a-00000000000d |       TASK | Generate ansible inventory                                                                                                \n2022-06-01 09:29:11.902574 | 525400e6-4dcf-ba75-8f8a-00000000000d |      FATAL | Generate ansible inventory | localhost | error\u003d{\"changed\": false, \"error\": \"No IPs found for Standalone role on ctlplane network\", \"msg\": \"Error generating inventory for overcloud: No IPs found for Standalone role on ctlplane network\", \"success\": false}\n\n```\n\nError raised from here:\nhttps://github.com/openstack/tripleo-common/blob/master/tripleo_commonhttps://github.com/openstack/tripleo-common/blob/master/tripleo_common/inventory.py#L360/inventory.py#L360",
      "revId": "9d147ee983a096136b1bc6f9161609cb0d1449bc",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b67b2840_4264e67f",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 1019722
      },
      "writtenOn": "2022-06-01T09:45:20Z",
      "side": 1,
      "message": "Hey hjensas. Are you able to take a quick peek at this one? Seems we\u0027re doing something wrong with the baremetal_deployment.yaml file. This is what gets generated:\n\n`/home/stack/composable_roles/network/baremetal_deployment.yaml`\n```\n- name: Standalone\n  count: 1\n  defaults:\n    profile: aio\n    network_config:\n      template: /home/stack/composable_roles/network/nic-configs/controller.j2\n    networks:\n    - network: ctlplane\n      vif: true\n    - network: external\n    - network: internal_api\n    - network: storage\n    - network: storage_mgmt\n    - network: storage_nfs\n    - network: tenant\n\n```\n\nThe resulting file from the provision:\n```\n[stack@undercloud-0 ~]$ cat templates/overcloud-baremetal-deployed.yaml \nparameter_defaults:\n  DeployedServerPortMap:\n    overcloud-standalone-0-ctlplane:\n      fixed_ips:\n      - ip_address: 192.168.24.50\n  HostnameMap:\n    overcloud-standalone-0: overcloud-standalone-0\n  NodePortMap:\n    overcloud-standalone-0:\n      ctlplane:\n        ip_address: 192.168.24.50\n        ip_address_uri: 192.168.24.50\n        ip_subnet: 192.168.24.50/24\n      external:\n        ip_address: 10.0.0.148\n        ip_address_uri: 10.0.0.148\n        ip_subnet: 10.0.0.148/24\n      internal_api:\n        ip_address: 172.17.1.10\n        ip_address_uri: 172.17.1.10\n        ip_subnet: 172.17.1.10/24\n      storage:\n        ip_address: 172.17.3.20\n        ip_address_uri: 172.17.3.20\n        ip_subnet: 172.17.3.20/24\n      storage_mgmt:\n        ip_address: 172.17.4.102\n        ip_address_uri: 172.17.4.102\n        ip_subnet: 172.17.4.102/24\n      storage_nfs:\n        ip_address: 172.17.0.79\n        ip_address_uri: 172.17.0.79\n        ip_subnet: 172.17.0.79/20\n      tenant:\n        ip_address: 172.17.2.29\n        ip_address_uri: 172.17.2.29\n        ip_subnet: 172.17.2.29/24\n  StandaloneCount: 1\n  StandaloneHostnameFormat: \u0027%stackname%-standalone-%index%\u0027\nresource_registry:\n  OS::TripleO::DeployedServer::ControlPlanePort: /usr/share/openstack-tripleo-heat-templates/deployed-server/deployed-neutron-port.yaml\n  OS::TripleO::Standalone::Ports::ExternalPort: /usr/share/openstack-tripleo-heat-templates/network/ports/deployed_external.yaml\n  OS::TripleO::Standalone::Ports::InternalApiPort: /usr/share/openstack-tripleo-heat-templates/network/ports/deployed_internal_api.yaml\n  OS::TripleO::Standalone::Ports::StorageMgmtPort: /usr/share/openstack-tripleo-heat-templates/network/ports/deployed_storage_mgmt.yaml\n  OS::TripleO::Standalone::Ports::StorageNFSPort: /usr/share/openstack-tripleo-heat-templates/network/ports/deployed_storage_nfs.yaml\n  OS::TripleO::Standalone::Ports::StoragePort: /usr/share/openstack-tripleo-heat-templates/network/ports/deployed_storage.yaml\n  OS::TripleO::Standalone::Ports::TenantPort: /usr/share/openstack-tripleo-heat-templates/network/ports/deployed_tenant.yaml\n```\n\nThe RoleNetHostnameMap:\n```\n[stack@undercloud-0 ~]$ cat overcloud-deploy/overcloud/outputs/RoleNetHostnameMap \nStandalone:\n  canonical:\n  - aio-0.redhat.local\n  ctlplane:\n  - aio-0.ctlplane.redhat.local\n  external:\n  - aio-0.external.redhat.local\n  internal_api:\n  - aio-0.internalapi.redhat.local\n  storage:\n  - aio-0.storage.redhat.local\n  storage_mgmt:\n  - aio-0.storagemgmt.redhat.local\n  storage_nfs:\n  - aio-0.storagenfs.redhat.local\n  tenant:\n  - aio-0.tenant.redhat.local\n```\n\nSo we have some issue working with this at this point here I guess:\nhttps://github.com/openstack/tripleo-heat-templates/blob/master/puppet/role.role.j2.yaml#L266-L275",
      "revId": "9d147ee983a096136b1bc6f9161609cb0d1449bc",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6c15b5e5_001604af",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 1019722
      },
      "writtenOn": "2022-06-01T10:30:19Z",
      "side": 1,
      "message": "Ah!I found it, new patchset coming",
      "parentUuid": "b67b2840_4264e67f",
      "revId": "9d147ee983a096136b1bc6f9161609cb0d1449bc",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    }
  ]
}