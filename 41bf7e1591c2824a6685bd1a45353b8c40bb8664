{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "122bef47_e344e70a",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1016110
      },
      "writtenOn": "2021-12-09T09:45:06Z",
      "side": 1,
      "message": "I wonder why tripleo doesn\u0027t create the configuration file directly.\n\nAnyway, the review is still WIP, does it mean it\u0027s not fully tested?\n\n(for the record, grep/awk can be unified, but that\u0027s a fix for tripleo documentation first)",
      "revId": "41bf7e1591c2824a6685bd1a45353b8c40bb8664",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "da148669_6152d4fb",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1018946
      },
      "writtenOn": "2021-12-09T14:23:04Z",
      "side": 1,
      "message": "Tripleo doesn\u0027t create the file at the moment. However I talked James Slagle and he pointed me to new upstream change https://review.opendev.org/c/openstack/tripleo-heat-templates/+/817816 , which is going to solve the problem. Taking that into considerations I encourage you to comment on the upstream patch to help move it forward. I\u0027ll close this change in favour of upstream change, unless somebody think we need this change as well.",
      "parentUuid": "122bef47_e344e70a",
      "revId": "41bf7e1591c2824a6685bd1a45353b8c40bb8664",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "cf984e4c_f4b48aed",
        "filename": "plugins/tripleo-undercloud/templates/heatrc.j2",
        "patchSetId": 2
      },
      "lineNbr": 5,
      "author": {
        "id": 1011919
      },
      "writtenOn": "2022-01-13T10:13:12Z",
      "side": 1,
      "message": "In my test environment there were two entries matching that patter, ending up with the IP variable with two values:\n\n[stack@undercloud-0 ~]$ IP\u003d`cat /etc/hosts | grep \"undercloud-0.redhat.local undercloud-0$\" | awk \u0027{print $1}\u0027`\n[stack@undercloud-0 ~]$ echo $IP\n192.168.24.1 127.0.0.1\n\n\n[stack@undercloud-0 ~]$ cat /etc/hosts\n# START_HOST_ENTRIES_FOR_STACK: qe-Cloud-0\n172.17.3.108 ceph-0.redhat.local ceph-0\n172.17.3.108 ceph-0.storage.redhat.local ceph-0.storage\n172.17.4.136 ceph-0.storagemgmt.redhat.local ceph-0.storagemgmt\n192.168.24.39 ceph-0.ctlplane.redhat.local ceph-0.ctlplane\n172.17.3.130 ceph-1.redhat.local ceph-1\n172.17.3.130 ceph-1.storage.redhat.local ceph-1.storage\n172.17.4.12 ceph-1.storagemgmt.redhat.local ceph-1.storagemgmt\n192.168.24.40 ceph-1.ctlplane.redhat.local ceph-1.ctlplane\n172.17.3.55 ceph-2.redhat.local ceph-2\n172.17.3.55 ceph-2.storage.redhat.local ceph-2.storage\n172.17.4.62 ceph-2.storagemgmt.redhat.local ceph-2.storagemgmt\n192.168.24.36 ceph-2.ctlplane.redhat.local ceph-2.ctlplane\n172.17.1.19 compute-0.redhat.local compute-0\n172.17.3.113 compute-0.storage.redhat.local compute-0.storage\n172.17.1.19 compute-0.internalapi.redhat.local compute-0.internalapi\n172.17.2.38 compute-0.tenant.redhat.local compute-0.tenant\n192.168.24.33 compute-0.ctlplane.redhat.local compute-0.ctlplane\n172.17.1.76 compute-1.redhat.local compute-1\n172.17.3.106 compute-1.storage.redhat.local compute-1.storage\n172.17.1.76 compute-1.internalapi.redhat.local compute-1.internalapi\n172.17.2.16 compute-1.tenant.redhat.local compute-1.tenant\n192.168.24.43 compute-1.ctlplane.redhat.local compute-1.ctlplane\n172.17.1.27 controller-0.redhat.local controller-0\n172.17.3.76 controller-0.storage.redhat.local controller-0.storage\n172.17.4.58 controller-0.storagemgmt.redhat.local controller-0.storagemgmt\n172.17.1.27 controller-0.internalapi.redhat.local controller-0.internalapi\n172.17.2.143 controller-0.tenant.redhat.local controller-0.tenant\n10.0.0.130 controller-0.external.redhat.local controller-0.external\n192.168.24.30 controller-0.ctlplane.redhat.local controller-0.ctlplane\n172.17.1.112 controller-1.redhat.local controller-1\n172.17.3.10 controller-1.storage.redhat.local controller-1.storage\n172.17.4.15 controller-1.storagemgmt.redhat.local controller-1.storagemgmt\n172.17.1.112 controller-1.internalapi.redhat.local controller-1.internalapi\n172.17.2.123 controller-1.tenant.redhat.local controller-1.tenant\n10.0.0.127 controller-1.external.redhat.local controller-1.external\n192.168.24.7 controller-1.ctlplane.redhat.local controller-1.ctlplane\n172.17.1.120 controller-2.redhat.local controller-2\n172.17.3.112 controller-2.storage.redhat.local controller-2.storage\n172.17.4.148 controller-2.storagemgmt.redhat.local controller-2.storagemgmt\n172.17.1.120 controller-2.internalapi.redhat.local controller-2.internalapi\n172.17.2.61 controller-2.tenant.redhat.local controller-2.tenant\n10.0.0.119 controller-2.external.redhat.local controller-2.external\n192.168.24.42 controller-2.ctlplane.redhat.local controller-2.ctlplane\n\n192.168.24.1 undercloud-0.ctlplane.redhat.local undercloud-0.ctlplane\n192.168.24.150  overcloud.ctlplane.redhat.local\n172.17.3.150  overcloud.storage.redhat.local\n172.17.4.150  overcloud.storagemgmt.redhat.local\n172.17.1.150  overcloud.internalapi.redhat.local\n10.0.0.150  overcloud.redhat.local\n# END_HOST_ENTRIES_FOR_STACK: qe-Cloud-0\n# START_HOST_ENTRIES_FOR_STACK: undercloud\n192.168.24.1 undercloud-0.redhat.local undercloud-0\n192.168.24.1 undercloud-0.external.redhat.local undercloud-0.external\n192.168.24.1 undercloud-0.ctlplane.redhat.local undercloud-0.ctlplane\n\n# END_HOST_ENTRIES_FOR_STACK: undercloud\n127.0.0.1   undercloud-0.redhat.local undercloud-0\n127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4\n::1         localhost localhost.localdomain localhost6 localhost6.localdomain6\n10.0.0.7 freeipa-0.redhat.local freeipa-0\n### BEGIN Overcloud Entries\n# Creating block\n### END Overcloud Entries\n\nThe solution has been to add -m 1 to grep, which specifies to just print out the first match in case of multiple matches:\n\n[stack@undercloud-0 ~]$ IP\u003d`cat /etc/hosts | grep -m 1 \"undercloud-0.redhat.local undercloud-0$\" | awk \u0027{print $1}\u0027`\n[stack@undercloud-0 ~]$ echo $IP\n192.168.24.1\n[stack@undercloud-0 ~]$ vi heatrc \n[stack@undercloud-0 ~]$ source heatrc \n[stack@undercloud-0 ~]$ echo $IP\n192.168.24.1\n[stack@undercloud-0 ~]$ echo $OS_ENDPOINT\nhttp://192.168.24.1:8006/v1/admin",
      "revId": "41bf7e1591c2824a6685bd1a45353b8c40bb8664",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    }
  ]
}