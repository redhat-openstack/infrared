{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "f8186851_f858e59b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1006843
      },
      "writtenOn": "2022-04-27T11:40:06Z",
      "side": 1,
      "message": "I\u0027ve been using this patchset for testing OSP17 for several months, no idea who to ask for a review. ",
      "revId": "7246c8b5a451e69ec7b134e9cf917912022db18c",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "3ad5a95a_23e5d69c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1005097
      },
      "writtenOn": "2022-05-03T09:07:57Z",
      "side": 1,
      "message": "Makes sense to me, in case this wont affect any existing deployments then +2, as I dont expect proper prefix implementation will be done anytime soon, imho likely ever because of its complexity related to the OSP deployment itself.",
      "revId": "7246c8b5a451e69ec7b134e9cf917912022db18c",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d863d659_7c6fbd39",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1005097
      },
      "writtenOn": "2022-05-03T09:12:47Z",
      "side": 1,
      "message": "(note to be clear, I am talking about prefixes on libvirt/qemu level (qemu:///session separation support or similarly powerful implementation), not on the osp level, these might be actually achievable, possibly already working and used)",
      "revId": "7246c8b5a451e69ec7b134e9cf917912022db18c",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6bcfade4_93e540e3",
        "filename": "plugins/tripleo-overcloud/templates/instackenv.json.j2",
        "patchSetId": 4
      },
      "lineNbr": 52,
      "author": {
        "id": 1001189
      },
      "writtenOn": "2022-05-12T01:13:10Z",
      "side": 1,
      "message": "I have slight concern about this approach.\nAfaik it\u0027s not set that node cannot have dashes in their names.\nI do realize even existing code would have issue with that - but if that would be concidered as precedence, then it could be precedence of behavior that utilizing dash in name one can control profile and custom suffix for the node (e.g. controller-default-0, controller-modified-1 etc).\n\nSo it may be worth considering more precise approach.\n\nThat said, I did found there are 5 existing virsh profiles with dash in name, four for openshift-* and vqfx-pfe :\n- https://github.com/redhat-openstack/infrared/blob/master/plugins/virsh/defaults/topology/nodes/openshift-worker.yml (as also openshift-infra, openshift-master, openshift-tester)\n- https://github.com/redhat-openstack/infrared/blob/master/plugins/virsh/defaults/topology/nodes/vqfx-pfe.yml\n\nBut I found no usage of those in CI jobs definitions (possibly not used anymore?).\nFor openshift-* ones there are few mentions there in name of parameters but appears they are not used for virsh provisioning or such.",
      "range": {
        "startLine": 52,
        "startChar": 42,
        "endLine": 52,
        "endChar": 48
      },
      "revId": "7246c8b5a451e69ec7b134e9cf917912022db18c",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6fd5e51a_2e9ee2c7",
        "filename": "plugins/tripleo-overcloud/templates/instackenv.json.j2",
        "patchSetId": 4
      },
      "lineNbr": 52,
      "author": {
        "id": 1006843
      },
      "writtenOn": "2022-05-12T09:44:30Z",
      "side": 1,
      "message": "I am trying to deal with the --prefix feature where Infrared uses prefix for all its resources i.e. prefix-$name (for networks, vm names, ...), so all the names have prefix followed by dash and then whatever the name of resource is.\nhttps://github.com/redhat-openstack/infrared/blob/master/plugins/virsh/tasks/load_topology.yml#L17\nI can possibly add additional condition to check if prefix is defined If It is defined then we can set as profile name whatever is between first and last dash.\n\nGenerally I am just trying to unblock myself and progress with OSP17, not really trying to rewrite Infrared so any suggestion or patch is welcome.",
      "parentUuid": "6bcfade4_93e540e3",
      "range": {
        "startLine": 52,
        "startChar": 42,
        "endLine": 52,
        "endChar": 48
      },
      "revId": "7246c8b5a451e69ec7b134e9cf917912022db18c",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c7f4b6a2_598d3895",
        "filename": "plugins/tripleo-overcloud/templates/instackenv.json.j2",
        "patchSetId": 4
      },
      "lineNbr": 52,
      "author": {
        "id": 1001189
      },
      "writtenOn": "2022-05-18T10:42:43Z",
      "side": 1,
      "message": "If prefix can be detectable here, i believe it would be best to here strip just the prefix explicitly. As that is Your intention with patch.\n\nBut I\u0027m afraid it is not possible in any clean way (I do not see it being passed to ir-oc)?\nYour approach may be likely best what can be done here, though it leaves the potential for future issues when node would be named with dashes too - so maybe leave at least comment in place about that? (About the intention of removing the virsh prefix and that it may eat part of dash-named node names)\n\nOther thing I wonder is - while virsh prefix naming is there, shouldn\u0027t still nodes have the proper short (non-prefixed) name somewhere?\nOr will the endup being named ${prefix}-controller-0 in the final deployed env?",
      "parentUuid": "6fd5e51a_2e9ee2c7",
      "range": {
        "startLine": 52,
        "startChar": 42,
        "endLine": 52,
        "endChar": 48
      },
      "revId": "7246c8b5a451e69ec7b134e9cf917912022db18c",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "91e098ac_1e8ef587",
        "filename": "plugins/tripleo-overcloud/templates/instackenv.json.j2",
        "patchSetId": 4
      },
      "lineNbr": 52,
      "author": {
        "id": 1006843
      },
      "writtenOn": "2022-05-19T16:00:59Z",
      "side": 1,
      "message": "The prefix is specified as an option in virsh ir plugin and all the resource such as networks or vms have it included in their names so the name of nodes would be i.e. ${prefix}-controller-0 and I do not really know how to easily (without significant refactor) detect the prefix.\nSo would be adding a comment into the code which would explain it more good enough? In the end of the day setting the profile name into instackenv.yaml based on the node name (and  is not the best way how to do it but It would require some refactor of the code to change that.",
      "parentUuid": "c7f4b6a2_598d3895",
      "range": {
        "startLine": 52,
        "startChar": 42,
        "endLine": 52,
        "endChar": 48
      },
      "revId": "7246c8b5a451e69ec7b134e9cf917912022db18c",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "2bb9942a_713825de",
        "filename": "plugins/tripleo-overcloud/templates/instackenv.json.j2",
        "patchSetId": 4
      },
      "lineNbr": 52,
      "author": {
        "id": 1001189
      },
      "writtenOn": "2022-06-08T15:58:50Z",
      "side": 1,
      "message": "Hm, I think You are right, i cannot find any reasonably easy way how to achieve that either.\nBest what i could think of is to detect prefix shared by all virt nodes in the ansible code, which references this template and pass it into here as variable.\nThat could be more precise then just dash splitting, but still not 100% correct/safe, and neither it seems worth the effort the extra effort it would need to do right.",
      "parentUuid": "91e098ac_1e8ef587",
      "range": {
        "startLine": 52,
        "startChar": 42,
        "endLine": 52,
        "endChar": 48
      },
      "revId": "7246c8b5a451e69ec7b134e9cf917912022db18c",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    }
  ]
}