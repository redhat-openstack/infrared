{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "8858f5f1_4c3e26d1",
        "filename": "plugins/tripleo-overcloud/files/generate_baremetal_deployment_from_roles_data.py",
        "patchSetId": 5
      },
      "lineNbr": 41,
      "author": {
        "id": 1015563
      },
      "writtenOn": "2022-03-17T08:07:16Z",
      "side": 1,
      "message": "This is infrared opinionated.\n\nThe profile is used for scheduling, and the value depends on what is configured in ironic node properties. It is possible to schedule in different ways, profile, resource_class etc. And it is entirely up to the user to define the profile and/or resource_class property of the ironic node.\n\nI can see how the type and profile properties are useful for infrared. But if we propose an upstream version of this I think we want to remove these to keep it simple.",
      "range": {
        "startLine": 37,
        "startChar": 0,
        "endLine": 41,
        "endChar": 24
      },
      "revId": "a7c5f766446bef4434874ede724b344b40a5a619",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d8f742e0_7a35d9a8",
        "filename": "plugins/tripleo-overcloud/files/generate_baremetal_deployment_from_roles_data.py",
        "patchSetId": 5
      },
      "lineNbr": 41,
      "author": {
        "id": 1016110
      },
      "writtenOn": "2022-03-17T14:27:21Z",
      "side": 1,
      "message": "So there is no guidelines upstream for profiles? In fact, I see the tripleo-docs marks the profile option (and the advanced matching) as deprecated:\nhttps://docs.openstack.org/project-deploy-guide/tripleo-docs/latest/provisioning/baremetal_provision.html#baremetal-provision-configuration\n\nSo I\u0027d gladly remove this code, if everything still works (need to check the rest of infrared). I will remove it in the next iteration.",
      "parentUuid": "8858f5f1_4c3e26d1",
      "range": {
        "startLine": 37,
        "startChar": 0,
        "endLine": 41,
        "endChar": 24
      },
      "revId": "a7c5f766446bef4434874ede724b344b40a5a619",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5037cd8a_253d367a",
        "filename": "plugins/tripleo-overcloud/files/generate_baremetal_deployment_from_roles_data.py",
        "patchSetId": 5
      },
      "lineNbr": 52,
      "author": {
        "id": 1015563
      },
      "writtenOn": "2022-03-16T14:45:05Z",
      "side": 1,
      "message": "Instead of trying to gess what is in network_data.yaml it would be better to just load network_data.yaml? Baremetal network definitions is using \u0027name_lower\u0027 from network data.",
      "range": {
        "startLine": 46,
        "startChar": 8,
        "endLine": 52,
        "endChar": 36
      },
      "revId": "a7c5f766446bef4434874ede724b344b40a5a619",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "08a3530a_8d16a9dc",
        "filename": "plugins/tripleo-overcloud/files/generate_baremetal_deployment_from_roles_data.py",
        "patchSetId": 5
      },
      "lineNbr": 52,
      "author": {
        "id": 1016110
      },
      "writtenOn": "2022-03-16T15:20:02Z",
      "side": 1,
      "message": "Thanks, I didn\u0027t know that, and I will definitely add a new parameter to read the network data file.",
      "parentUuid": "5037cd8a_253d367a",
      "range": {
        "startLine": 46,
        "startChar": 8,
        "endLine": 52,
        "endChar": 36
      },
      "revId": "a7c5f766446bef4434874ede724b344b40a5a619",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "625b22b1_165c6dcd",
        "filename": "plugins/tripleo-overcloud/files/generate_baremetal_deployment_from_roles_data.py",
        "patchSetId": 5
      },
      "lineNbr": 112,
      "author": {
        "id": 1018946
      },
      "writtenOn": "2022-03-16T15:14:15Z",
      "side": 1,
      "message": "If we continue script execution with nc\u003d1 we should warn user that he probably missed node-count for some nodes and default 1 is used ,IMHO.",
      "range": {
        "startLine": 112,
        "startChar": 8,
        "endLine": 112,
        "endChar": 14
      },
      "revId": "a7c5f766446bef4434874ede724b344b40a5a619",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6394f7a8_8f6f54fa",
        "filename": "plugins/tripleo-overcloud/files/generate_baremetal_deployment_from_roles_data.py",
        "patchSetId": 5
      },
      "lineNbr": 112,
      "author": {
        "id": 1016110
      },
      "writtenOn": "2022-03-16T15:20:02Z",
      "side": 1,
      "message": "here I wasn\u0027t sure, but maybe we can simply remove the special case and default to none, and just fail later because, well, there won\u0027t be any node for that role. Not sure. Harald, what do you think?",
      "parentUuid": "625b22b1_165c6dcd",
      "range": {
        "startLine": 112,
        "startChar": 8,
        "endLine": 112,
        "endChar": 14
      },
      "revId": "a7c5f766446bef4434874ede724b344b40a5a619",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d57af6a9_fa8f14a1",
        "filename": "plugins/tripleo-overcloud/files/generate_baremetal_deployment_from_roles_data.py",
        "patchSetId": 5
      },
      "lineNbr": 112,
      "author": {
        "id": 1015563
      },
      "writtenOn": "2022-03-16T20:58:49Z",
      "side": 1,
      "message": "If we default to a non integer value like None, schema validation would fail schema validation if the user tries to use the generated yaml. I think that would be a good default. +1",
      "parentUuid": "6394f7a8_8f6f54fa",
      "range": {
        "startLine": 112,
        "startChar": 8,
        "endLine": 112,
        "endChar": 14
      },
      "revId": "a7c5f766446bef4434874ede724b344b40a5a619",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "77e3e7f4_1bbce33e",
        "filename": "plugins/tripleo-overcloud/files/generate_baremetal_deployment_from_roles_data.py",
        "patchSetId": 5
      },
      "lineNbr": 112,
      "author": {
        "id": 1016110
      },
      "writtenOn": "2022-03-16T22:03:54Z",
      "side": 1,
      "message": "Would it fail because the generated file would have less roles than expected?",
      "parentUuid": "d57af6a9_fa8f14a1",
      "range": {
        "startLine": 112,
        "startChar": 8,
        "endLine": 112,
        "endChar": 14
      },
      "revId": "a7c5f766446bef4434874ede724b344b40a5a619",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "70640374_c9c239d3",
        "filename": "plugins/tripleo-overcloud/files/generate_baremetal_deployment_from_roles_data.py",
        "patchSetId": 5
      },
      "lineNbr": 112,
      "author": {
        "id": 1015563
      },
      "writtenOn": "2022-03-17T08:07:16Z",
      "side": 1,
      "message": "I was thinking validation would fail because count is not an integer.\nhttps://opendev.org/openstack/tripleo-ansible/src/branch/master/tripleo_ansible/ansible_plugins/module_utils/baremetal_deploy.py#L173\n\nBut looking more into the code I see you only add the role if count is \u003e 0.\nWhy not just add the roles no matter if node_count is?",
      "parentUuid": "77e3e7f4_1bbce33e",
      "range": {
        "startLine": 112,
        "startChar": 8,
        "endLine": 112,
        "endChar": 14
      },
      "revId": "a7c5f766446bef4434874ede724b344b40a5a619",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b2e1f4e8_345af496",
        "filename": "plugins/tripleo-overcloud/files/generate_baremetal_deployment_from_roles_data.py",
        "patchSetId": 5
      },
      "lineNbr": 112,
      "author": {
        "id": 1016110
      },
      "writtenOn": "2022-03-17T14:27:21Z",
      "side": 1,
      "message": "But if I add the role with count: 0, wouldn\u0027t that break anything? Or at least, wouldn\u0027t the role with count:0 be useless?",
      "parentUuid": "70640374_c9c239d3",
      "range": {
        "startLine": 112,
        "startChar": 8,
        "endLine": 112,
        "endChar": 14
      },
      "revId": "a7c5f766446bef4434874ede724b344b40a5a619",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6cdce087_71d2cab0",
        "filename": "plugins/tripleo-overcloud/files/generate_baremetal_deployment_from_roles_data.py",
        "patchSetId": 5
      },
      "lineNbr": 146,
      "author": {
        "id": 1015563
      },
      "writtenOn": "2022-03-16T14:38:12Z",
      "side": 1,
      "message": "nit, typo.",
      "range": {
        "startLine": 146,
        "startChar": 43,
        "endLine": 146,
        "endChar": 48
      },
      "revId": "a7c5f766446bef4434874ede724b344b40a5a619",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "33b0af76_ce3acfea",
        "filename": "plugins/tripleo-overcloud/tasks/generate_baremetal_deployment.yml",
        "patchSetId": 5
      },
      "lineNbr": 14,
      "author": {
        "id": 1018946
      },
      "writtenOn": "2022-03-16T14:13:30Z",
      "side": 1,
      "message": "I have suggestion to remove  -c ... flag from arguments and use {{template_base }}roles/nodes.yaml file generated in previous task \"create the nodes file\" as a source of this information.\n\nI\u0027m much in favour of this change.",
      "revId": "a7c5f766446bef4434874ede724b344b40a5a619",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "473ef881_fc951c95",
        "filename": "plugins/tripleo-overcloud/tasks/generate_baremetal_deployment.yml",
        "patchSetId": 5
      },
      "lineNbr": 14,
      "author": {
        "id": 1016110
      },
      "writtenOn": "2022-03-16T14:20:59Z",
      "side": 1,
      "message": "Is nodes.yaml always available in tripleo upstream too?\nIf not, I can\u0027t use it in the script, because I\u0027d like to propose this script upstream.\nThe file can be used to feed the -c parameters though.",
      "parentUuid": "33b0af76_ce3acfea",
      "revId": "a7c5f766446bef4434874ede724b344b40a5a619",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e6738a32_675874b4",
        "filename": "plugins/tripleo-overcloud/tasks/generate_baremetal_deployment.yml",
        "patchSetId": 5
      },
      "lineNbr": 14,
      "author": {
        "id": 1015563
      },
      "writtenOn": "2022-03-16T14:38:12Z",
      "side": 1,
      "message": "nodes.yaml is an infrared thing, so it would not be available upstream.",
      "parentUuid": "473ef881_fc951c95",
      "revId": "a7c5f766446bef4434874ede724b344b40a5a619",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f6249daf_b5743ddb",
        "filename": "plugins/tripleo-overcloud/tasks/generate_baremetal_deployment.yml",
        "patchSetId": 5
      },
      "lineNbr": 14,
      "author": {
        "id": 1018946
      },
      "writtenOn": "2022-03-16T14:46:37Z",
      "side": 1,
      "message": "so, maybe instead of using it directly we could reuse logic from nodes.yaml to create this vars dynamic",
      "parentUuid": "e6738a32_675874b4",
      "revId": "a7c5f766446bef4434874ede724b344b40a5a619",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e751a309_7d046f60",
        "filename": "plugins/tripleo-overcloud/tasks/generate_baremetal_deployment.yml",
        "patchSetId": 5
      },
      "lineNbr": 14,
      "author": {
        "id": 1016110
      },
      "writtenOn": "2022-03-16T15:20:02Z",
      "side": 1,
      "message": "Yes, agreed.",
      "parentUuid": "f6249daf_b5743ddb",
      "revId": "a7c5f766446bef4434874ede724b344b40a5a619",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    }
  ]
}